<!-- <!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Australian Electorates Map</title>
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <style>
        .tooltip {
            position: absolute;
            background-color: white;
            padding: 5px;
            border: 1px solid #ccc;
            border-radius: 5px;
            pointer-events: none;
            opacity: 0;
        }
    </style>
</head>
<body>
    <svg width="960" height="600"></svg>

    <div class="tooltip"></div>

    <script>
        const svg = d3.select("svg");
        const width = +svg.attr("width");
        const height = +svg.attr("height");

        const projection = d3.geoMercator()
            .center([133, -28])
            .scale(700)
            .translate([width / 2, height / 2]);

        const path = d3.geoPath().projection(projection);

        // Add tooltip
        const tooltip = d3.select("body").append("div")
            .attr("class", "tooltip")
            .style("opacity", 0);

        // Create zoom behavior
        const zoom = d3.zoom()
            .scaleExtent([1, 8]) // Limit zoom to between 1x and 8x
            .on("zoom", zoomed);

        // Apply zoom behavior to the SVG element
        svg.call(zoom);

        function zoomed(event) {
            svg.selectAll("path")
                .attr("transform", event.transform); // Apply the zoom transformation to paths
        }

        // Load GeoJSON file containing electorate boundaries
        d3.json("2021-cwlth_electoral_boundaries_geojson.geojson").then(function(geojson) {
            // Load CSV file containing MP data
            d3.csv("FamilynameRepsCSV.csv").then(function(data) {
                // Convert electorate names to uppercase for consistency
                data.forEach(function(d) {
                    d.Electorate = d.Electorate.toUpperCase();
                });

                // Add interactivity to map
                svg.selectAll("path")
                    .data(geojson.features)
                    .enter().append("path")
                    .attr("d", path)
                    .style("fill", "steelblue")
                    .style("stroke", "white")
                    .style("stroke-width", 0.5)
                    // Add interactivity
                    .on("mouseover", function(event, d) {
                        d3.select(this).style("fill", "orange"); // Change color on mouseover
                        tooltip.transition()
                            .duration(200)
                            .style("opacity", .9);
                        let tooltipContent = d.properties.Elect_div; // Start with electorate name
                        // Find corresponding MP info
                        const mp = data.find(mp => mp.Electorate === d.properties.Elect_div.toUpperCase());
                        if (mp) {
                            tooltipContent += `<br><strong>${mp["Honorific"]}</strong><br>${mp["First Name"]} ${mp["Surname"]}<br>${mp["Political Party"]}<br>${mp["Telephone"]}`;
                        }
                        tooltip.html(tooltipContent)
                            .style("left", (event.pageX) + "px")
                            .style("top", (event.pageY - 28) + "px");
                    })
                    .on("mouseout", function() {
                        d3.select(this).style("fill", "steelblue"); // Revert color on mouseout
                        tooltip.transition()
                            .duration(500)
                            .style("opacity", 0);
                    });
            });
        });
    </script>
</body>
</html> -->

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Australian Electorates Map</title>
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <style>
        .tooltip {
            position: absolute;
            background-color: white;
            padding: 5px;
            border: 1px solid #ccc;
            border-radius: 5px;
            pointer-events: none;
            opacity: 0;
        }
    </style>
</head>
<body>
    <svg width="960" height="600"></svg>

    <div class="tooltip"></div>

    <script>
        const svg = d3.select("svg");
        const width = +svg.attr("width");
        const height = +svg.attr("height");

        const projection = d3.geoMercator()
            .center([133, -28])
            .scale(700)
            .translate([width / 2, height / 2]);

        const path = d3.geoPath().projection(projection);

        // Add tooltip
        const tooltip = d3.select("body").append("div")
            .attr("class", "tooltip")
            .style("opacity", 0);

        // Create zoom behavior
        const zoom = d3.zoom()
            .scaleExtent([1, 8]) // Limit zoom to between 1x and 8x
            .on("zoom", zoomed);

        // Apply zoom behavior to the SVG element
        svg.call(zoom);

        function zoomed(event) {
            svg.selectAll("path")
                .attr("transform", event.transform); // Apply the zoom transformation to paths
        }

        // Load GeoJSON file containing electorate boundaries
        d3.json("2021-cwlth_electoral_boundaries_geojson.geojson").then(function(geojson) {
            // Load CSV file containing MP data
            d3.csv("FamilynameRepsCSV.csv").then(function(data) {
                // Convert electorate names to uppercase for consistency
                data.forEach(function(d) {
                    d.Electorate = d.Electorate.toUpperCase();
                });

                // Add interactivity to map
                svg.selectAll("path")
                    .data(geojson.features)
                    .enter().append("path")
                    .attr("d", path)
                    .style("fill", function(d) {
                        // Find corresponding MP info
                        const mp = data.find(mp => mp.Electorate === d.properties.Elect_div.toUpperCase());
                        if (mp) {
                            // Use different colors for "Yes" and "No" votes
                            return mp["Voted for"] === "Yes" ? "green" : "red";
                        } else {
                            return "steelblue"; // Default color for electorates without MP data
                        }
                    })
                    .style("stroke", "white")
                    .style("stroke-width", 0.5)
                    // Add interactivity
                    .on("mouseover", function(event, d) {
                        d3.select(this).style("fill", "orange"); // Change color on mouseover
                        tooltip.transition()
                            .duration(200)
                            .style("opacity", .9);
                        tooltip.html(d.properties.Elect_div) // Display electorate name on tooltip
                            .style("left", (event.pageX) + "px")
                            .style("top", (event.pageY - 28) + "px");
                    })
                    .on("mouseout", function() {
                        d3.select(this).style("fill", function(d) {
                            const mp = data.find(mp => mp.Electorate === d.properties.Elect_div.toUpperCase());
                            return mp ? (mp["Voted for"] === "Yes" ? "green" : "red") : "steelblue";
                        }); // Revert color on mouseout
                        tooltip.transition()
                            .duration(500)
                            .style("opacity", 0);
                    });
            });
        });
    </script>
</body>
</html>

